{"./":{"url":"./","title":"Introduction","keywords":"","body":"build web doc 用于构建含评论区（与 GitHub issue 关联）的 GitHun Page 的教程，文档已通过网页形式部署于：https://xy-plus.github.io/webdoc/ 快速构建 执行以下命令： git clone https://github.com/xy-plus/webdoc.git cd webdoc gitbook install gitbook serve 然后访问：http://localhost:4000 即可。 注意：此时你看到的评论区链接的是我的 GitHub issue ，如果试图登录会跳转至本文部署的页面，而非 localhost 。 如果你需要将评论区改为关联到自己的 GitHub issue ，请阅读 3.2 评论区 和 4. 部署网页 。 const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitalk.render('gitalk-container') require(['gitbook'], function(gitbook) { const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitbook.events.bind('page.change', initMygitalk) function initMygitalk() { gitalk.render('gitalk-container') } }) "},"1. 编写文档.html":{"url":"1. 编写文档.html","title":"1. 编写文档","keywords":"","body":"编写文档 先上网搜一下怎么用 gitbook 写书，根据要求写好文档和 SUMMARY.md 。 const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitalk.render('gitalk-container') require(['gitbook'], function(gitbook) { const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitbook.events.bind('page.change', initMygitalk) function initMygitalk() { gitalk.render('gitalk-container') } }) "},"2. 本地浏览.html":{"url":"2. 本地浏览.html","title":"2. 本地浏览","keywords":"","body":"本地浏览 在包含 SUMMARY.md 的目录下执行：gitbook serve 。 没有这个命令的读者请自行安装 const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitalk.render('gitalk-container') require(['gitbook'], function(gitbook) { const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitbook.events.bind('page.change', initMygitalk) function initMygitalk() { gitalk.render('gitalk-container') } }) "},"3. 添加插件.html":{"url":"3. 添加插件.html","title":"3. 添加插件","keywords":"","body":"添加插件 在 SUMMARY.md 的同级目录下创建配置文件 book.json 。 const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitalk.render('gitalk-container') require(['gitbook'], function(gitbook) { const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitbook.events.bind('page.change', initMygitalk) function initMygitalk() { gitalk.render('gitalk-container') } }) "},"3.1. 参考配置.html":{"url":"3.1. 参考配置.html","title":"3.1. 参考配置","keywords":"","body":"参考配置 这里给出本网页使用的配置文件： { \"plugins\": [ \"chapter-fold\", \"code\", \"search-pro\", \"github\", \"localized-footer\", \"ancre-navigation\", \"-sharing\" ], \"pluginsConfig\": { \"github\": { \"url\": \"https://github.com/xy-plus/webdoc\" }, \"localized-footer\": { \"filename\": \"gitbook/comment.html\" } }, \"styles\": { \"website\": \"gitbook/website.css\" } } const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitalk.render('gitalk-container') require(['gitbook'], function(gitbook) { const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitbook.events.bind('page.change', initMygitalk) function initMygitalk() { gitalk.render('gitalk-container') } }) "},"3.2. 评论区.html":{"url":"3.2. 评论区.html","title":"3.2. 评论区","keywords":"","body":"评论区 实现方法 通过 localized-footer 为每一个页面的末尾增加一段 html 代码： { \"plugins\": [\"localized-footer\"], \"pluginsConfig\": { \"localized-footer\": { \"filename\": \"gitbook/comment.html\" } } } 参数介绍 创建目录用于存放相关文件，我创建了目录 gitbook 用于存放相关文件，文件名为 comment.html 。 我们先单独看一下评论区控件的代码： const gitalk = new Gitalk({ clientID: \"GitHub Application Client ID\", clientSecret: \"GitHub Application Client Secret\", repo: \"GitHub repo\", owner: \"GitHub repo owner\", admin: [ \"GitHub repo owner and collaborators, only these guys can initialize github issues\" ], createIssueManually: true, id: document.title }); clientID 和 clientSecret 需要通过在 GitHub 上注册获得：https://github.com/settings/applications/new 。 感谢 @moon548834 的提醒：注册中的 callback URL 不可以随便写！！必须和主页一样（对于本例是 https://xy-plus.github.io）。否则用户授权登录会有问题。会出现 redirect_uri_mismatch 问题导致无法评论和初始化 issue 。 由于评论区与 GitHub issue 关联，所以需要为每个页面创建一个 issue ，createIssueManually: true 使得管理员能够一键创建 issue ，issue 的标题为 id ，这里使用 document.title 作为页面 id 。 快速生成 修改 profile.conf ，将参数修改为你自己的。注意格式不要乱，因为这一段将被直接嵌入 html 。 执行 set_file.sh ， gitbook/comment.html 将自动根据 profile.conf 生成。 参考代码 当然，你也可以复制我的代码。由于未知的原因（我太菜），下面那段代码需要两次 const gitalk = new Gitalk 填写两次参数，如果有更好的实现方式请提出，谢谢。 const gitalk = new Gitalk({ clientID: '\"GitHub Application Client ID\"', clientSecret: \"GitHub Application Client Secret\", repo: \"GitHub repo\", owner: \"GitHub repo owner\", admin: [ \"GitHub repo owner and collaborators, only these guys can initialize github issues\" ], createIssueManually: true, id: document.title }); gitalk.render(\"gitalk-container\"); require([\"gitbook\"], function(gitbook) { const gitalk = new Gitalk({ clientID: \"GitHub Application Client ID\", clientSecret: \"GitHub Application Client Secret\", repo: \"GitHub repo\", owner: \"GitHub repo owner\", admin: [ \"GitHub repo owner and collaborators, only these guys can initialize github issues\" ], createIssueManually: true, id: document.title }); gitbook.events.bind(\"page.change\", initMygitalk); function initMygitalk() { gitalk.render(\"gitalk-container\"); } }); const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitalk.render('gitalk-container') require(['gitbook'], function(gitbook) { const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitbook.events.bind('page.change', initMygitalk) function initMygitalk() { gitalk.render('gitalk-container') } }) "},"4. 部署网页.html":{"url":"4. 部署网页.html","title":"4. 部署网页","keywords":"","body":"部署网页 注意到运行完 gitbook serve 之后，目录下自动生成了 _book 目录，里面包含了生成网页的 html 代码。有两个办法在 GitHub 上 创建网页（本文采用部署到当前仓库）。 部署到新仓库 将 _book 作为新的仓库 push 到 GitHub 上，在仓库的 Settings > GitHub Pages 下选择 sourse 为 master branch 。 为了省事我写了个脚本： update_book.sh gitbook build cd _book rm .gitignore git init git remote add origin https://github.com/xxxxxxxxxxxx.git git add . git commit -m \"update\" git push origin master -f cd .. 部署到当前仓库 修改 _book 目录名为 docs ，在仓库的 Settings > GitHub Pages 下选择 sourse 为 master branch/docs folder 。 以后编写完文档后需要 先删除 原先的 docs 目录，运行 gitbook serve 之后将生成的 _book 目录改名为 docs 为了省事我又写了个脚本： update_book.sh rm -rf docs gitbook build mv _book docs cd docs rm update_book.sh rm .gitignore git add . git commit -m \"update web\" cd .. git add . git commit -m \"update doc\" git push const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitalk.render('gitalk-container') require(['gitbook'], function(gitbook) { const gitalk = new Gitalk({ clientID: '00c208c2cc4bae4c64cc', clientSecret: '3dd4511e0db4d8fa14616a395ccb3e05151032ed', repo: 'webdoc', owner: 'xy-plus', admin: ['xy-plus'], createIssueManually: true, id: document.title }) gitbook.events.bind('page.change', initMygitalk) function initMygitalk() { gitalk.render('gitalk-container') } }) "}}